# 可视化窗口管理工具使用说明

## 功能介绍
这是一个可视化的窗口管理工具，让你可以通过图形界面轻松设置窗口的排列位置，支持自定义网格布局和保存配置。

## 启动方式
```bash
python window_manager_gui.py
```

## 界面说明

### 1. 配置设置区域
- **行数/列数**: 设置网格的行数和列数（默认2行3列）
- **宽度/高度**: 设置屏幕分辨率（默认2560×1440）
- **使用工作区**: 勾选后会避开任务栏，取消勾选则使用全屏

### 2. 可用窗口列表（左侧）
- 显示当前所有可见的窗口
- 已分配位置的窗口会显示 `→ [行,列]` 标记
- **双击窗口**: 弹出位置选择对话框
- **刷新窗口列表**: 重新扫描当前窗口

### 3. 网格布局区域（右侧）
- 显示网格布局，每个格子代表一个位置
- **空格子**: 显示灰色，标注 "位置 X,Y (空)"
- **已分配格子**: 显示蓝色，显示窗口标题
- **点击格子**: 
  - 空格子：选择窗口分配到该位置
  - 已占用格子：询问是否移除该窗口

## 操作流程

### 基本使用
1. **启动程序**: 运行 `python window_manager_gui.py`
2. **调整配置**: 根据需要修改行数、列数、分辨率等设置
3. **分配窗口**: 
   - 方法1：双击左侧窗口列表中的窗口，选择位置
   - 方法2：点击右侧空的网格位置，选择窗口
4. **预览布局**: 点击"预览布局"查看具体的坐标和尺寸信息
5. **应用设置**: 点击"应用设置"实际移动和调整窗口

### 高级功能
- **保存配置**: 将当前的窗口分配保存为JSON文件
- **加载配置**: 从JSON文件加载之前保存的配置
- **清空设置**: 清除所有窗口分配

## 使用技巧

### 1. 推荐设置
- **2560×1440屏幕**: 使用2行3列，每个窗口约853×720像素
- **1920×1080屏幕**: 使用2行2列或2行3列
- **多显示器**: 可以为每个显示器创建不同的配置文件

### 2. 窗口选择
- 程序会自动过滤掉系统窗口、工具窗口和最小化窗口
- 如果某个窗口没有出现在列表中，尝试点击"刷新窗口列表"
- 当前程序窗口不会出现在列表中（避免自己管理自己）

### 3. 配置管理
- 建议为不同的工作场景保存不同的配置文件
- 配置文件包含窗口的标题和类名，可以在不同时间加载相同的布局
- 如果窗口标题经常变化，程序会尝试通过类名匹配

## 注意事项

1. **权限要求**: 程序需要操作其他窗口，某些受保护的系统窗口可能无法移动
2. **窗口状态**: 最小化的窗口会被自动恢复后再移动
3. **分辨率变化**: 如果更换显示器或分辨率，需要重新调整配置
4. **程序兼容性**: 某些全屏程序或特殊窗口可能不支持调整大小

## 快捷操作

- **Ctrl+S**: 保存配置（在文件对话框中）
- **Ctrl+O**: 加载配置（在文件对话框中）
- **双击窗口**: 快速分配位置
- **右键网格**: 移除窗口分配

## 故障排除

### 程序无法启动
- 确保安装了Python 3.8+
- 确保在Windows系统上运行
- 检查是否有杀毒软件阻止

### 窗口移动失败
- 某些程序可能有特殊保护，无法被外部程序移动
- 尝试以管理员权限运行程序
- 确保目标窗口没有被其他程序锁定

### 窗口列表为空
- 点击"刷新窗口列表"
- 确保有其他可见窗口打开
- 检查窗口是否被最小化

## 扩展功能建议

如果需要更多功能，可以考虑：
- 添加热键支持（如Win+T快速平铺）
- 支持多显示器配置
- 添加窗口透明度调整
- 支持更复杂的布局模式（如黄金分割）

---

**作者**: AI助手  
**版本**: 1.0  
**更新日期**: 2024年